<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>hdict.content.argument.apply API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>hdict.content.argument.apply</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#  Copyright (c) 2023. Davi Pereira dos Santos
#  This file is part of the hdict project.
#  Please respect the license - more about this in the section (*) below.
#
#  hdict is free software: you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation, either version 3 of the License, or
#  (at your option) any later version.
#
#  hdict is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with hdict.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
#
#  (*) Removing authorship by any means, e.g. by distribution of derived
#  works or verbatim, obfuscated, compiled or rewritten versions of any
#  part of this work is illegal and it is unethical regarding the effort and
#  time spent here.
#
from __future__ import annotations

from inspect import isfunction
from inspect import signature
from itertools import chain
from random import Random

from hosh import Hosh

from hdict.content.argument import AbsBaseArgument, AbsArgument
from hdict.content.argument.field import field
from hdict.customjson import truncate
from hdict.hoshfication import f2hosh


class apply(AbsBaseArgument):
    &#34;&#34;&#34;
    Function application

    Single output application is defined by attribute: &#39;apply(f).my_output_field&#39;.
    Multioutput application is defined by a call: &#39;apply(f)(&#34;output_field1&#34;, &#34;output_field2&#34;)&#39;.

    &gt;&gt;&gt; from hdict import apply, value
    &gt;&gt;&gt; f = lambda a, b: a**b
    &gt;&gt;&gt; v = apply(f, 5, b=7)
    &gt;&gt;&gt; v
    λ(5 7)
    &gt;&gt;&gt; g = lambda x, y: x**y
    &gt;&gt;&gt; apply(g, y=value(7777), x=v)
    λ(x=λ(5 7) 7777)

    &gt;&gt;&gt; v2 = apply(f, a=v, b=value(7))
    &gt;&gt;&gt; v2
    λ(a=λ(5 7) 7)
    &gt;&gt;&gt; v.enclosure({}, &#34;j&#34;).value
    78125
    &gt;&gt;&gt; v2.enclosure({}, &#34;j&#34;)
    λ(a=λ(5 7) 7)
    &gt;&gt;&gt; v2.enclosure({}, &#34;j&#34;).value
    17763568394002504646778106689453125

    &gt;&gt;&gt; f = lambda a,b, c=1,d=2,e=13: 0
    &gt;&gt;&gt; apply(f).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; ap = apply(f,3)
    &gt;&gt;&gt; ap.requirements
    {&#39;a&#39;: 3, &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; ap
    λ(3 b c=default(1) d=default(2) e=default(13))
    &gt;&gt;&gt; ap.enclosure({&#34;b&#34;: value(77)}, &#34;j&#34;)
    λ(3 b c=1 d=2 e=13)
    &gt;&gt;&gt; ap
    λ(3 b c=default(1) d=default(2) e=default(13))
    &gt;&gt;&gt; d = {&#34;f&#34;: ap, &#34;b&#34;: 5, &#34;d&#34;: 1, &#34;e&#34;: field(&#34;b&#34;)}
    &gt;&gt;&gt; d
    {&#39;f&#39;: λ(3 b c=default(1) d=default(2) e=default(13)), &#39;b&#39;: 5, &#39;d&#39;: 1, &#39;e&#39;: field(b)}
    &gt;&gt;&gt; from hdict.aux_frozendict import handle_items
    &gt;&gt;&gt; handle_items(d, previous={&#34;b&#34;: 5})
    {&#39;b&#39;: 5, &#39;f&#39;: λ(3 b c=1 d=2 e=13), &#39;d&#39;: 1, &#39;e&#39;: 5}
    &gt;&gt;&gt; d
    {&#39;f&#39;: λ(3 b c=default(1) d=default(2) e=default(13)), &#39;b&#39;: 5, &#39;d&#39;: 1, &#39;e&#39;: field(b)}
    &gt;&gt;&gt; apply(f,3,4).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5,6).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5,6,7).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: 7}
    &gt;&gt;&gt; apply(f,d=5).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: 5, &#39;e&#39;: default(13)}
    &gt;&gt;&gt; f = lambda a,b, *contentarg, c=1,d=2,e=13, **kwargs: 0
    &gt;&gt;&gt; apply(f,3,4,5,6,7,8).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: 7, _5: 8}
    &gt;&gt;&gt; apply(f,x=3,e=4,d=5,c=6,b=7,a=8).requirements
    {&#39;a&#39;: 8, &#39;b&#39;: 7, &#39;c&#39;: 6, &#39;d&#39;: 5, &#39;e&#39;: 4, &#39;x&#39;: 3}
    &gt;&gt;&gt; apply(f,3,c=77,x=5).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: field(b), &#39;c&#39;: 77, &#39;d&#39;: default(2), &#39;e&#39;: default(13), &#39;x&#39;: 5}
    &gt;&gt;&gt; apply(f,b=77,x=5).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: 77, &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13), &#39;x&#39;: 5}
    &#34;&#34;&#34;

    _sampleable, isfield, _requirements = None, False, None

    def __init__(self, appliable: callable | apply | field, *applied_args, fhosh: Hosh = None, _sampleable=None, **applied_kwargs):
        from hdict.content.argument.aux_apply import handle_args

        self.appliable = appliable
        if isinstance(fhosh, str):  # pragma: no cover
            fhosh = Hosh.fromid(fhosh)

        if isinstance(appliable, apply):  # &#34;clone&#34; mode
            self.fhosh = fhosh or appliable.fhosh
            self.fargs, self.fkwargs = appliable.fargs.copy(), appliable.fkwargs.copy()
            self.isfield = appliable.isfield
            self._sampleable = appliable.sampleable if _sampleable is None else _sampleable
            self.appliable = appliable.appliable
        elif isinstance(appliable, field):
            # TODO: o que era isso mesmo?::  &#34;function will be provided by hdict&#34;-mode constrains &#39;applied_args&#39;
            self.fhosh = fhosh
            self.fargs, self.fkwargs = handle_args(None, applied_args, applied_kwargs)
            self.isfield = True
            self._sampleable = _sampleable
        elif callable(appliable):
            if not isfunction(appliable):  # &#34;not function&#34; means &#34;custom callable&#34;
                if not hasattr(appliable, &#34;__call__&#34;):  # pragma: no cover
                    raise Exception(f&#34;Cannot infer method to apply non custom callable type &#39;{type(appliable).__name__}&#39;.&#34;)
                if not hasattr(appliable, &#34;hosh&#34;):  # pragma: no cover
                    raise Exception(f&#34;Missing &#39;hosh&#39; attribute while applying custom callable class &#39;{type(appliable).__name__}&#39;&#34;)
                # noinspection PyUnresolvedReferences
                sig = signature(appliable.__call__)
                # noinspection PyUnresolvedReferences
                self.fhosh = fhosh or appliable.hosh
            else:
                self.fhosh = f2hosh(appliable) if fhosh is None else fhosh
                sig = signature(appliable)

            # Separate positional parameters from named parameters looking at &#39;f&#39; signature.
            self.fargs, self.fkwargs = handle_args(sig, applied_args, applied_kwargs)
            self._sampleable = _sampleable
        else:  # pragma: no cover
            raise Exception(f&#34;Cannot apply type &#39;{type(appliable).__name__}&#39;.&#34;)

    @property
    def sampleable(self):
        if self._sampleable is None:
            gen = (req.sampleable for req in self.fargs.values())
            kwgen = (req.sampleable for req in self.fkwargs.values())
            self._sampleable = any(gen) or any(kwgen)
        return self._sampleable

    @property
    def ahosh(self):
        return self.fhosh.rev  # &#39;f&#39; identified as an appliable function

    def clone(self, _sampleable=None):
        return apply(self, _sampleable=_sampleable)

    def sample(self, rnd: int | Random = None):
        if not self.sampleable:
            return self
        clone = self.clone(_sampleable=False)
        for k, v in clone.fargs.items():
            clone.fargs[k] = v.sample(rnd)
        for k, v in clone.fkwargs.items():
            clone.fkwargs[k] = v.sample(rnd)
        return clone

    def enclosure(self, data, key):
        from hdict.content.entry.closure import Closure

        return Closure(self, data, [key])

    def __call__(self, *out, **kwout):
        from hdict.applyout import ApplyOut

        if out and kwout:  # pragma: no cover
            raise Exception(f&#34;Cannot mix translated (**kwargs) and non translated (*args) outputs.&#34;)
        if len(out) == 1:
            out = out[0]
        return ApplyOut(self, out or tuple(kwout.items()))

    def __getattr__(self, item):
        # REMINDER: Work around getattribute missing all properties.
        if item not in [&#34;ahosh&#34;, &#34;requirements&#34;, &#34;hosh&#34;]:
            from hdict.applyout import ApplyOut

            return ApplyOut(self, item)
        return self.__getattribute__(item)  # pragma: no cover

    def __rshift__(self, other):  # pragma: no cover
        raise Exception(f&#34;Cannot pipeline an application before specifying the output field.&#34;)

    def __rrshift__(self, other):  # pragma: no cover
        raise Exception(f&#34;Cannot apply before specifying the output field.&#34;)

    def __repr__(self):
        from hdict import value

        lst = []
        for param, content in sorted(chain(self.fargs.items(), self.fkwargs.items())):
            match content:
                case field(name=param):
                    lst.append(f&#34;{param}&#34;)
                case value():
                    lst.append(truncate(repr(content), width=7))
                case AbsArgument():
                    lst.append(f&#34;{param}={repr(content)}&#34;)
                case _:
                    raise Exception(f&#34;&#34;)
        return f&#34;λ({&#39; &#39;.join(lst)})&#34;

    @property
    def requirements(self):
        if self._requirements is None:
            self._requirements = {k: v for k, v in sorted(chain(self.fargs.items(), self.fkwargs.items()))}
        return self._requirements</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="hdict.content.argument.apply.apply"><code class="flex name class">
<span>class <span class="ident">apply</span></span>
<span>(</span><span>appliable: callable | <a title="hdict.content.argument.apply.apply" href="#hdict.content.argument.apply.apply">apply</a> | field, *applied_args, fhosh: Hosh = None, **applied_kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Function application</p>
<p>Single output application is defined by attribute: 'apply(f).my_output_field'.
Multioutput application is defined by a call: 'apply(f)("output_field1", "output_field2")'.</p>
<pre><code class="language-python-repl">&gt;&gt;&gt; from hdict import apply, value
&gt;&gt;&gt; f = lambda a, b: a**b
&gt;&gt;&gt; v = apply(f, 5, b=7)
&gt;&gt;&gt; v
λ(5 7)
&gt;&gt;&gt; g = lambda x, y: x**y
&gt;&gt;&gt; apply(g, y=value(7777), x=v)
λ(x=λ(5 7) 7777)
</code></pre>
<pre><code class="language-python-repl">&gt;&gt;&gt; v2 = apply(f, a=v, b=value(7))
&gt;&gt;&gt; v2
λ(a=λ(5 7) 7)
&gt;&gt;&gt; v.enclosure({}, &quot;j&quot;).value
78125
&gt;&gt;&gt; v2.enclosure({}, &quot;j&quot;)
λ(a=λ(5 7) 7)
&gt;&gt;&gt; v2.enclosure({}, &quot;j&quot;).value
17763568394002504646778106689453125
</code></pre>
<pre><code class="language-python-repl">&gt;&gt;&gt; f = lambda a,b, c=1,d=2,e=13: 0
&gt;&gt;&gt; apply(f).requirements
{'a': field(a), 'b': field(b), 'c': default(1), 'd': default(2), 'e': default(13)}
&gt;&gt;&gt; ap = apply(f,3)
&gt;&gt;&gt; ap.requirements
{'a': 3, 'b': field(b), 'c': default(1), 'd': default(2), 'e': default(13)}
&gt;&gt;&gt; ap
λ(3 b c=default(1) d=default(2) e=default(13))
&gt;&gt;&gt; ap.enclosure({&quot;b&quot;: value(77)}, &quot;j&quot;)
λ(3 b c=1 d=2 e=13)
&gt;&gt;&gt; ap
λ(3 b c=default(1) d=default(2) e=default(13))
&gt;&gt;&gt; d = {&quot;f&quot;: ap, &quot;b&quot;: 5, &quot;d&quot;: 1, &quot;e&quot;: field(&quot;b&quot;)}
&gt;&gt;&gt; d
{'f': λ(3 b c=default(1) d=default(2) e=default(13)), 'b': 5, 'd': 1, 'e': field(b)}
&gt;&gt;&gt; from hdict.aux_frozendict import handle_items
&gt;&gt;&gt; handle_items(d, previous={&quot;b&quot;: 5})
{'b': 5, 'f': λ(3 b c=1 d=2 e=13), 'd': 1, 'e': 5}
&gt;&gt;&gt; d
{'f': λ(3 b c=default(1) d=default(2) e=default(13)), 'b': 5, 'd': 1, 'e': field(b)}
&gt;&gt;&gt; apply(f,3,4).requirements
{'a': 3, 'b': 4, 'c': default(1), 'd': default(2), 'e': default(13)}
&gt;&gt;&gt; apply(f,3,4,5).requirements
{'a': 3, 'b': 4, 'c': 5, 'd': default(2), 'e': default(13)}
&gt;&gt;&gt; apply(f,3,4,5,6).requirements
{'a': 3, 'b': 4, 'c': 5, 'd': 6, 'e': default(13)}
&gt;&gt;&gt; apply(f,3,4,5,6,7).requirements
{'a': 3, 'b': 4, 'c': 5, 'd': 6, 'e': 7}
&gt;&gt;&gt; apply(f,d=5).requirements
{'a': field(a), 'b': field(b), 'c': default(1), 'd': 5, 'e': default(13)}
&gt;&gt;&gt; f = lambda a,b, *contentarg, c=1,d=2,e=13, **kwargs: 0
&gt;&gt;&gt; apply(f,3,4,5,6,7,8).requirements
{'a': 3, 'b': 4, 'c': 5, 'd': 6, 'e': 7, _5: 8}
&gt;&gt;&gt; apply(f,x=3,e=4,d=5,c=6,b=7,a=8).requirements
{'a': 8, 'b': 7, 'c': 6, 'd': 5, 'e': 4, 'x': 3}
&gt;&gt;&gt; apply(f,3,c=77,x=5).requirements
{'a': 3, 'b': field(b), 'c': 77, 'd': default(2), 'e': default(13), 'x': 5}
&gt;&gt;&gt; apply(f,b=77,x=5).requirements
{'a': field(a), 'b': 77, 'c': default(1), 'd': default(2), 'e': default(13), 'x': 5}
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class apply(AbsBaseArgument):
    &#34;&#34;&#34;
    Function application

    Single output application is defined by attribute: &#39;apply(f).my_output_field&#39;.
    Multioutput application is defined by a call: &#39;apply(f)(&#34;output_field1&#34;, &#34;output_field2&#34;)&#39;.

    &gt;&gt;&gt; from hdict import apply, value
    &gt;&gt;&gt; f = lambda a, b: a**b
    &gt;&gt;&gt; v = apply(f, 5, b=7)
    &gt;&gt;&gt; v
    λ(5 7)
    &gt;&gt;&gt; g = lambda x, y: x**y
    &gt;&gt;&gt; apply(g, y=value(7777), x=v)
    λ(x=λ(5 7) 7777)

    &gt;&gt;&gt; v2 = apply(f, a=v, b=value(7))
    &gt;&gt;&gt; v2
    λ(a=λ(5 7) 7)
    &gt;&gt;&gt; v.enclosure({}, &#34;j&#34;).value
    78125
    &gt;&gt;&gt; v2.enclosure({}, &#34;j&#34;)
    λ(a=λ(5 7) 7)
    &gt;&gt;&gt; v2.enclosure({}, &#34;j&#34;).value
    17763568394002504646778106689453125

    &gt;&gt;&gt; f = lambda a,b, c=1,d=2,e=13: 0
    &gt;&gt;&gt; apply(f).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; ap = apply(f,3)
    &gt;&gt;&gt; ap.requirements
    {&#39;a&#39;: 3, &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; ap
    λ(3 b c=default(1) d=default(2) e=default(13))
    &gt;&gt;&gt; ap.enclosure({&#34;b&#34;: value(77)}, &#34;j&#34;)
    λ(3 b c=1 d=2 e=13)
    &gt;&gt;&gt; ap
    λ(3 b c=default(1) d=default(2) e=default(13))
    &gt;&gt;&gt; d = {&#34;f&#34;: ap, &#34;b&#34;: 5, &#34;d&#34;: 1, &#34;e&#34;: field(&#34;b&#34;)}
    &gt;&gt;&gt; d
    {&#39;f&#39;: λ(3 b c=default(1) d=default(2) e=default(13)), &#39;b&#39;: 5, &#39;d&#39;: 1, &#39;e&#39;: field(b)}
    &gt;&gt;&gt; from hdict.aux_frozendict import handle_items
    &gt;&gt;&gt; handle_items(d, previous={&#34;b&#34;: 5})
    {&#39;b&#39;: 5, &#39;f&#39;: λ(3 b c=1 d=2 e=13), &#39;d&#39;: 1, &#39;e&#39;: 5}
    &gt;&gt;&gt; d
    {&#39;f&#39;: λ(3 b c=default(1) d=default(2) e=default(13)), &#39;b&#39;: 5, &#39;d&#39;: 1, &#39;e&#39;: field(b)}
    &gt;&gt;&gt; apply(f,3,4).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: default(2), &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5,6).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: default(13)}
    &gt;&gt;&gt; apply(f,3,4,5,6,7).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: 7}
    &gt;&gt;&gt; apply(f,d=5).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: field(b), &#39;c&#39;: default(1), &#39;d&#39;: 5, &#39;e&#39;: default(13)}
    &gt;&gt;&gt; f = lambda a,b, *contentarg, c=1,d=2,e=13, **kwargs: 0
    &gt;&gt;&gt; apply(f,3,4,5,6,7,8).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: 4, &#39;c&#39;: 5, &#39;d&#39;: 6, &#39;e&#39;: 7, _5: 8}
    &gt;&gt;&gt; apply(f,x=3,e=4,d=5,c=6,b=7,a=8).requirements
    {&#39;a&#39;: 8, &#39;b&#39;: 7, &#39;c&#39;: 6, &#39;d&#39;: 5, &#39;e&#39;: 4, &#39;x&#39;: 3}
    &gt;&gt;&gt; apply(f,3,c=77,x=5).requirements
    {&#39;a&#39;: 3, &#39;b&#39;: field(b), &#39;c&#39;: 77, &#39;d&#39;: default(2), &#39;e&#39;: default(13), &#39;x&#39;: 5}
    &gt;&gt;&gt; apply(f,b=77,x=5).requirements
    {&#39;a&#39;: field(a), &#39;b&#39;: 77, &#39;c&#39;: default(1), &#39;d&#39;: default(2), &#39;e&#39;: default(13), &#39;x&#39;: 5}
    &#34;&#34;&#34;

    _sampleable, isfield, _requirements = None, False, None

    def __init__(self, appliable: callable | apply | field, *applied_args, fhosh: Hosh = None, _sampleable=None, **applied_kwargs):
        from hdict.content.argument.aux_apply import handle_args

        self.appliable = appliable
        if isinstance(fhosh, str):  # pragma: no cover
            fhosh = Hosh.fromid(fhosh)

        if isinstance(appliable, apply):  # &#34;clone&#34; mode
            self.fhosh = fhosh or appliable.fhosh
            self.fargs, self.fkwargs = appliable.fargs.copy(), appliable.fkwargs.copy()
            self.isfield = appliable.isfield
            self._sampleable = appliable.sampleable if _sampleable is None else _sampleable
            self.appliable = appliable.appliable
        elif isinstance(appliable, field):
            # TODO: o que era isso mesmo?::  &#34;function will be provided by hdict&#34;-mode constrains &#39;applied_args&#39;
            self.fhosh = fhosh
            self.fargs, self.fkwargs = handle_args(None, applied_args, applied_kwargs)
            self.isfield = True
            self._sampleable = _sampleable
        elif callable(appliable):
            if not isfunction(appliable):  # &#34;not function&#34; means &#34;custom callable&#34;
                if not hasattr(appliable, &#34;__call__&#34;):  # pragma: no cover
                    raise Exception(f&#34;Cannot infer method to apply non custom callable type &#39;{type(appliable).__name__}&#39;.&#34;)
                if not hasattr(appliable, &#34;hosh&#34;):  # pragma: no cover
                    raise Exception(f&#34;Missing &#39;hosh&#39; attribute while applying custom callable class &#39;{type(appliable).__name__}&#39;&#34;)
                # noinspection PyUnresolvedReferences
                sig = signature(appliable.__call__)
                # noinspection PyUnresolvedReferences
                self.fhosh = fhosh or appliable.hosh
            else:
                self.fhosh = f2hosh(appliable) if fhosh is None else fhosh
                sig = signature(appliable)

            # Separate positional parameters from named parameters looking at &#39;f&#39; signature.
            self.fargs, self.fkwargs = handle_args(sig, applied_args, applied_kwargs)
            self._sampleable = _sampleable
        else:  # pragma: no cover
            raise Exception(f&#34;Cannot apply type &#39;{type(appliable).__name__}&#39;.&#34;)

    @property
    def sampleable(self):
        if self._sampleable is None:
            gen = (req.sampleable for req in self.fargs.values())
            kwgen = (req.sampleable for req in self.fkwargs.values())
            self._sampleable = any(gen) or any(kwgen)
        return self._sampleable

    @property
    def ahosh(self):
        return self.fhosh.rev  # &#39;f&#39; identified as an appliable function

    def clone(self, _sampleable=None):
        return apply(self, _sampleable=_sampleable)

    def sample(self, rnd: int | Random = None):
        if not self.sampleable:
            return self
        clone = self.clone(_sampleable=False)
        for k, v in clone.fargs.items():
            clone.fargs[k] = v.sample(rnd)
        for k, v in clone.fkwargs.items():
            clone.fkwargs[k] = v.sample(rnd)
        return clone

    def enclosure(self, data, key):
        from hdict.content.entry.closure import Closure

        return Closure(self, data, [key])

    def __call__(self, *out, **kwout):
        from hdict.applyout import ApplyOut

        if out and kwout:  # pragma: no cover
            raise Exception(f&#34;Cannot mix translated (**kwargs) and non translated (*args) outputs.&#34;)
        if len(out) == 1:
            out = out[0]
        return ApplyOut(self, out or tuple(kwout.items()))

    def __getattr__(self, item):
        # REMINDER: Work around getattribute missing all properties.
        if item not in [&#34;ahosh&#34;, &#34;requirements&#34;, &#34;hosh&#34;]:
            from hdict.applyout import ApplyOut

            return ApplyOut(self, item)
        return self.__getattribute__(item)  # pragma: no cover

    def __rshift__(self, other):  # pragma: no cover
        raise Exception(f&#34;Cannot pipeline an application before specifying the output field.&#34;)

    def __rrshift__(self, other):  # pragma: no cover
        raise Exception(f&#34;Cannot apply before specifying the output field.&#34;)

    def __repr__(self):
        from hdict import value

        lst = []
        for param, content in sorted(chain(self.fargs.items(), self.fkwargs.items())):
            match content:
                case field(name=param):
                    lst.append(f&#34;{param}&#34;)
                case value():
                    lst.append(truncate(repr(content), width=7))
                case AbsArgument():
                    lst.append(f&#34;{param}={repr(content)}&#34;)
                case _:
                    raise Exception(f&#34;&#34;)
        return f&#34;λ({&#39; &#39;.join(lst)})&#34;

    @property
    def requirements(self):
        if self._requirements is None:
            self._requirements = {k: v for k, v in sorted(chain(self.fargs.items(), self.fkwargs.items()))}
        return self._requirements</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="hdict.content.argument.AbsBaseArgument" href="index.html#hdict.content.argument.AbsBaseArgument">AbsBaseArgument</a></li>
<li><a title="hdict.content.argument.AbsArgument" href="index.html#hdict.content.argument.AbsArgument">AbsArgument</a></li>
<li><a title="hdict.abs.AbsAny" href="../../abs/index.html#hdict.abs.AbsAny">AbsAny</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="hdict.content.argument.apply.apply.isfield"><code class="name">var <span class="ident">isfield</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="hdict.content.argument.apply.apply.ahosh"><code class="name">var <span class="ident">ahosh</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ahosh(self):
    return self.fhosh.rev  # &#39;f&#39; identified as an appliable function</code></pre>
</details>
</dd>
<dt id="hdict.content.argument.apply.apply.requirements"><code class="name">var <span class="ident">requirements</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def requirements(self):
    if self._requirements is None:
        self._requirements = {k: v for k, v in sorted(chain(self.fargs.items(), self.fkwargs.items()))}
    return self._requirements</code></pre>
</details>
</dd>
<dt id="hdict.content.argument.apply.apply.sampleable"><code class="name">var <span class="ident">sampleable</span></code></dt>
<dd>
<div class="desc"><p>bool(x) -&gt; bool</p>
<p>Returns True when the argument x is true, False otherwise.
The builtins True and False are the only two instances of the class bool.
The class bool is a subclass of the class int, and cannot be subclassed.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def sampleable(self):
    if self._sampleable is None:
        gen = (req.sampleable for req in self.fargs.values())
        kwgen = (req.sampleable for req in self.fkwargs.values())
        self._sampleable = any(gen) or any(kwgen)
    return self._sampleable</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="hdict.content.argument.apply.apply.clone"><code class="name flex">
<span>def <span class="ident">clone</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def clone(self, _sampleable=None):
    return apply(self, _sampleable=_sampleable)</code></pre>
</details>
</dd>
<dt id="hdict.content.argument.apply.apply.enclosure"><code class="name flex">
<span>def <span class="ident">enclosure</span></span>(<span>self, data, key)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def enclosure(self, data, key):
    from hdict.content.entry.closure import Closure

    return Closure(self, data, [key])</code></pre>
</details>
</dd>
<dt id="hdict.content.argument.apply.apply.sample"><code class="name flex">
<span>def <span class="ident">sample</span></span>(<span>self, rnd: int | Random = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sample(self, rnd: int | Random = None):
    if not self.sampleable:
        return self
    clone = self.clone(_sampleable=False)
    for k, v in clone.fargs.items():
        clone.fargs[k] = v.sample(rnd)
    for k, v in clone.fkwargs.items():
        clone.fkwargs[k] = v.sample(rnd)
    return clone</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="hdict.content.argument" href="index.html">hdict.content.argument</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="hdict.content.argument.apply.apply" href="#hdict.content.argument.apply.apply">apply</a></code></h4>
<ul class="two-column">
<li><code><a title="hdict.content.argument.apply.apply.ahosh" href="#hdict.content.argument.apply.apply.ahosh">ahosh</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.clone" href="#hdict.content.argument.apply.apply.clone">clone</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.enclosure" href="#hdict.content.argument.apply.apply.enclosure">enclosure</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.isfield" href="#hdict.content.argument.apply.apply.isfield">isfield</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.requirements" href="#hdict.content.argument.apply.apply.requirements">requirements</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.sample" href="#hdict.content.argument.apply.apply.sample">sample</a></code></li>
<li><code><a title="hdict.content.argument.apply.apply.sampleable" href="#hdict.content.argument.apply.apply.sampleable">sampleable</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>